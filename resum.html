<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
        <title>Title of the document</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>

        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>

        <style>
          html, body, #map {
              width: 100%;
              height: 100%;
          }
      </style>
    </head>

    <body class="bg-dark text-light">
        <h1 class="text-center mt-5 mb-5">Resum de l'activitat</h1>
        <table class="table table-dark table-striped">
            <tbody>
              <tr>
                <th class="text-end w-50">Tipus d'activitat</th>
                <td class="w-50" id="activity"></td>
              </tr>
              <tr>
                <th class="text-end w-50">Usuari</th>
                <td class="w-50" id="user"></td>
              </tr>
              <tr>
                <th class="text-end w-50">Data</th>
                <td class="w-50" id="fecha"></td>
              </tr>
              <tr>
                <th class="text-end w-50">Llargada</th>
                <td class="w-50" id="dist"></td>
              </tr>
            </tbody>
        </table>
        <p id="desc" class="text-center" style="color: #464646"></p>
        <div id="map"></div>
    </body>

    <script>
        function recuperar() {
          let dataTxt = localStorage.getItem("data");
          let data = JSON.parse(dataTxt)

          let dataMapTxt = localStorage.getItem("dataMap");
          let dataMap = JSON.parse(dataMapTxt)
          
          document.getElementById('activity').innerHTML = data.activity;

          document.getElementById('user').innerHTML = data.name;

          let date = new Date();
          let month = date.getMonth() + 1;
          let fecha = date.getDate() + "/" + month + "/" + date.getFullYear();
          document.getElementById("fecha").innerHTML = fecha;

          document.getElementById('dist').innerHTML = dataMap.distance;

          let desc = document.getElementById('desc');
          desc.innerHTML = data.description;

          let map = L.map('map').setView([dataMap.positions[0][0], dataMap.positions[0][1]], 14);
          let tiles = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
            id: 'mapbox/streets-v11',
            tileSize: 512,
            zoomOffset: -1,
          }).addTo(map);
          let multiPolyline = L.polyline(dataMap.positions, {color: 'blue', opacity: '70%'}).addTo(map);
          map.fitBounds(multiPolyline.getBounds());
       }
       recuperar();


    </script>

</html>